---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "restful_resource Resource - terraform-provider-restful"
subcategory: ""
description: |-
  restful_resource manages a restful resource.
---

# restful_resource (Resource)

`restful_resource` manages a restful resource.

## Example Usage

```terraform
resource "restful_resource" "rg" {
  path = format("/subscriptions/%s/resourceGroups/%s", var.subscription_id, "example")
  query = {
    api-version = ["2020-06-01"]
  }
  create_method = "PUT"
  poll_delete = {
    status_locator = "code"
    status = {
      success = "404"
      pending = ["202", "200"]
    }
  }
  body = {
    location = "westus"
    tags = {
      foo = "bar"
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `body` (Dynamic) The properties of the resource.
- `path` (String) The path used to create the resource, relative to the `base_url` of the provider.

### Optional

- `check_existance` (Boolean) Whether to check resource already existed? Defaults to `false`.
- `create_header` (Map of String) The header parameters that are applied to each create request. This overrides the `header` set in the resource block.
- `create_method` (String) The method used to create the resource. Possible values are `PUT`, `POST` and `PATCH`. This overrides the `create_method` set in the provider block (defaults to POST).
- `create_query` (Map of List of String) The query parameters that are applied to each create request. This overrides the `query` set in the resource block.
- `create_selector` (String) A selector in [gjson query syntax](https://github.com/tidwall/gjson/blob/master/SYNTAX.md#queries) query syntax, that is used when create returns a collection of resources, to select exactly one member resource of from it. By default, the whole response body is used as the body.
- `delete_body` (Dynamic) The payload for the `Delete` call.
- `delete_header` (Map of String) The header parameters that are applied to each delete request. This overrides the `header` set in the resource block.
- `delete_method` (String) The method used to delete the resource. Possible values are `DELETE`, `POST`, `PUT` and `PATCH`. This overrides the `delete_method` set in the provider block (defaults to DELETE).
- `delete_path` (String) The API path used to delete the resource. The `id` is used instead if `delete_path` is absent. This can be a string literal, or combined by following params: path param: `$(path)` expanded to `path`, body param: `$(body.x.y.z)` expands to the `x.y.z` property of the API body. Especially for the body param, it can add a chain of functions (applied from left to right), in the form of `$f1.f2(body)`. Supported functions include: `escape` (URL path escape, by default applied), `unescape` (URL path unescape), `base` (filepath base), `url_path` (path segment of a URL), `trim_path` (trim `path`).
- `delete_query` (Map of List of String) The query parameters that are applied to each delete request. This overrides the `query` set in the resource block.
- `ephemeral_body` (Dynamic) The ephemeral (write-only) properties of the resource. This will be merge-patched to the `body` to construct the actual request body.
- `force_new_attrs` (Set of String) A set of `body` attribute paths (in [gjson syntax](https://github.com/tidwall/gjson/blob/master/SYNTAX.md)) whose value once changed, will trigger a replace of this resource. Note this only take effects when the `body` is a unknown before apply. Technically, we do a JSON merge patch and check whether the attribute path appear in the merge patch.
- `header` (Map of String) The header parameters that are applied to each request. This overrides the `header` set in the provider block.
- `merge_patch_disabled` (Boolean) Whether to use a JSON Merge Patch as the request body in the PATCH update? This is only effective when `update_method` is set to `PATCH`. This overrides the `merge_patch_disabled` set in the provider block (defaults to `false`).
- `output_attrs` (Set of String) A set of `output` attribute paths (in [gjson syntax](https://github.com/tidwall/gjson/blob/master/SYNTAX.md)) that will be exported in the `output`. If this is not specified, all attributes will be exported by `output`.
- `poll_create` (Attributes) The polling option for the "Create" operation (see [below for nested schema](#nestedatt--poll_create))
- `poll_delete` (Attributes) The polling option for the "Delete" operation (see [below for nested schema](#nestedatt--poll_delete))
- `poll_update` (Attributes) The polling option for the "Update" operation (see [below for nested schema](#nestedatt--poll_update))
- `precheck_create` (Attributes List) An array of prechecks that need to pass prior to the "Create" operation. Exactly one of `mutex` or `api` should be specified. (see [below for nested schema](#nestedatt--precheck_create))
- `precheck_delete` (Attributes List) An array of prechecks that need to pass prior to the "Delete" operation. Exactly one of `mutex` or `api` should be specified. (see [below for nested schema](#nestedatt--precheck_delete))
- `precheck_update` (Attributes List) An array of prechecks that need to pass prior to the "Update" operation. Exactly one of `mutex` or `api` should be specified. (see [below for nested schema](#nestedatt--precheck_update))
- `query` (Map of List of String) The query parameters that are applied to each request. This overrides the `query` set in the provider block.
- `read_header` (Map of String) The header parameters that are applied to each read request. This overrides the `header` set in the resource block.
- `read_path` (String) The API path used to read the resource, which is used as the `id`. The `path` is used as the `id` instead if `read_path` is absent. This can be a string literal, or combined by following params: path param: `$(path)` expanded to `path`, body param: `$(body.x.y.z)` expands to the `x.y.z` property of the API body. Especially for the body param, it can add a chain of functions (applied from left to right), in the form of `$f1.f2(body)`. Supported functions include: `escape` (URL path escape, by default applied), `unescape` (URL path unescape), `base` (filepath base), `url_path` (path segment of a URL), `trim_path` (trim `path`).
- `read_query` (Map of List of String) The query parameters that are applied to each read request. This overrides the `query` set in the resource block.
- `read_response_template` (String) The raw template for transforming the response of reading (after selector). It can contain `$(body.x.y.z)` parameter that reference property from the response. This is only used to transform the read response to the same struct as the `body`.
- `read_selector` (String) A selector expression in [gjson query syntax](https://github.com/tidwall/gjson/blob/master/SYNTAX.md#queries), that is used when read returns a collection of resources, to select exactly one member resource of from it. By default, the whole response body is used as the body. The expression can contain parameters in the form of `$(body.x.y.z)`, which expands to the `x.y.z` property of the `output` of the resource state. Specially, the param can add a chain of functions (applied from left to right), in the form of `$f1.f2(body)`. Supported functions include: `escape` (URL path escape, by default applied), `unescape` (URL path unescape), `base` (filepath base), `url_path` (path segment of a URL), `trim_path` (trim `path`).
- `update_body_patches` (Attributes List) The body patches for update only. Any change here won't cause a update API call by its own, only changes from `body` does. Note that this is almost only useful for APIs that require *after-create* attribute for an update (e.g. the resource ID). (see [below for nested schema](#nestedatt--update_body_patches))
- `update_header` (Map of String) The header parameters that are applied to each update request. This overrides the `header` set in the resource block.
- `update_method` (String) The method used to update the resource. Possible values are `PUT`, `POST`, and `PATCH`. This overrides the `update_method` set in the provider block (defaults to PUT).
- `update_path` (String) The API path used to update the resource. The `id` is used instead if `update_path` is absent. This can be a string literal, or combined by following params: path param: `$(path)` expanded to `path`, body param: `$(body.x.y.z)` expands to the `x.y.z` property of the API body. Especially for the body param, it can add a chain of functions (applied from left to right), in the form of `$f1.f2(body)`. Supported functions include: `escape` (URL path escape, by default applied), `unescape` (URL path unescape), `base` (filepath base), `url_path` (path segment of a URL), `trim_path` (trim `path`).
- `update_query` (Map of List of String) The query parameters that are applied to each update request. This overrides the `query` set in the resource block.
- `write_only_attrs` (List of String) A list of paths (in [gjson syntax](https://github.com/tidwall/gjson/blob/master/SYNTAX.md)) to the attributes that are only settable, but won't be read in GET response. Prefer to use `ephemeral_body`.

### Read-Only

- `id` (String) The ID of the Resource.
- `output` (Dynamic) The response body. If `ephemeral_body` get returned by API, it will be removed from `output`.

<a id="nestedatt--poll_create"></a>
### Nested Schema for `poll_create`

Required:

- `status` (Attributes) The expected status sentinels for each polling state. (see [below for nested schema](#nestedatt--poll_create--status))
- `status_locator` (String) Specifies how to discover the status property. The format is either `code` or `scope.path`, where `scope` can be either `header` or `body`, and the `path` is using the [gjson syntax](https://github.com/tidwall/gjson/blob/master/SYNTAX.md). The `path` can contain `$(body.x.y.z)` parameter that reference property from either the response body (for `Create`, after selector), or `state.output` (for `Read`/`Update`/`Delete`).

Optional:

- `default_delay_sec` (Number) The interval between two pollings if there is no `Retry-After` in the response header, in second. Defaults to `10`.
- `header` (Map of String) The header parameters. This overrides the `header` set in the resource block.
- `url_locator` (String) Specifies how to discover the polling url. The format can be one of `header.path` (use the property at `path` in response header), `body.path` (use the property at `path` in response body) or `exact.value` (use the exact `value`). When absent, the current operation's URL is used for polling, execpt `Create` where it fallbacks to use the resource id as the polling URL.

<a id="nestedatt--poll_create--status"></a>
### Nested Schema for `poll_create.status`

Required:

- `success` (String) The expected status sentinel for suceess status.

Optional:

- `pending` (List of String) The expected status sentinels for pending status.



<a id="nestedatt--poll_delete"></a>
### Nested Schema for `poll_delete`

Required:

- `status` (Attributes) The expected status sentinels for each polling state. (see [below for nested schema](#nestedatt--poll_delete--status))
- `status_locator` (String) Specifies how to discover the status property. The format is either `code` or `scope.path`, where `scope` can be either `header` or `body`, and the `path` is using the [gjson syntax](https://github.com/tidwall/gjson/blob/master/SYNTAX.md). The `path` can contain `$(body.x.y.z)` parameter that reference property from either the response body (for `Create`, after selector), or `state.output` (for `Read`/`Update`/`Delete`).

Optional:

- `default_delay_sec` (Number) The interval between two pollings if there is no `Retry-After` in the response header, in second. Defaults to `10`.
- `header` (Map of String) The header parameters. This overrides the `header` set in the resource block.
- `url_locator` (String) Specifies how to discover the polling url. The format can be one of `header.path` (use the property at `path` in response header), `body.path` (use the property at `path` in response body) or `exact.value` (use the exact `value`). When absent, the current operation's URL is used for polling, execpt `Create` where it fallbacks to use the resource id as the polling URL.

<a id="nestedatt--poll_delete--status"></a>
### Nested Schema for `poll_delete.status`

Required:

- `success` (String) The expected status sentinel for suceess status.

Optional:

- `pending` (List of String) The expected status sentinels for pending status.



<a id="nestedatt--poll_update"></a>
### Nested Schema for `poll_update`

Required:

- `status` (Attributes) The expected status sentinels for each polling state. (see [below for nested schema](#nestedatt--poll_update--status))
- `status_locator` (String) Specifies how to discover the status property. The format is either `code` or `scope.path`, where `scope` can be either `header` or `body`, and the `path` is using the [gjson syntax](https://github.com/tidwall/gjson/blob/master/SYNTAX.md). The `path` can contain `$(body.x.y.z)` parameter that reference property from either the response body (for `Create`, after selector), or `state.output` (for `Read`/`Update`/`Delete`).

Optional:

- `default_delay_sec` (Number) The interval between two pollings if there is no `Retry-After` in the response header, in second. Defaults to `10`.
- `header` (Map of String) The header parameters. This overrides the `header` set in the resource block.
- `url_locator` (String) Specifies how to discover the polling url. The format can be one of `header.path` (use the property at `path` in response header), `body.path` (use the property at `path` in response body) or `exact.value` (use the exact `value`). When absent, the current operation's URL is used for polling, execpt `Create` where it fallbacks to use the resource id as the polling URL.

<a id="nestedatt--poll_update--status"></a>
### Nested Schema for `poll_update.status`

Required:

- `success` (String) The expected status sentinel for suceess status.

Optional:

- `pending` (List of String) The expected status sentinels for pending status.



<a id="nestedatt--precheck_create"></a>
### Nested Schema for `precheck_create`

Optional:

- `api` (Attributes) Keeps waiting until the specified API meets the success status (see [below for nested schema](#nestedatt--precheck_create--api))
- `mutex` (String) The name of the mutex, which implies the resource will keep waiting until this mutex is held

<a id="nestedatt--precheck_create--api"></a>
### Nested Schema for `precheck_create.api`

Required:

- `path` (String) The path used to query readiness, relative to the `base_url` of the provider.
- `status` (Attributes) The expected status sentinels for each polling state. (see [below for nested schema](#nestedatt--precheck_create--api--status))
- `status_locator` (String) Specifies how to discover the status property. The format is either `code` or `scope.path`, where `scope` can be either `header` or `body`, and the `path` is using the [gjson syntax](https://github.com/tidwall/gjson/blob/master/SYNTAX.md).

Optional:

- `default_delay_sec` (Number) The interval between two pollings if there is no `Retry-After` in the response header, in second. Defaults to `10`.
- `header` (Map of String) The header parameters. This overrides the `header` set in the resource block.
- `query` (Map of List of String) The query parameters. This overrides the `query` set in the resource block.

<a id="nestedatt--precheck_create--api--status"></a>
### Nested Schema for `precheck_create.api.status`

Required:

- `success` (String) The expected status sentinel for suceess status.

Optional:

- `pending` (List of String) The expected status sentinels for pending status.




<a id="nestedatt--precheck_delete"></a>
### Nested Schema for `precheck_delete`

Optional:

- `api` (Attributes) Keeps waiting until the specified API meets the success status (see [below for nested schema](#nestedatt--precheck_delete--api))
- `mutex` (String) The name of the mutex, which implies the resource will keep waiting until this mutex is held

<a id="nestedatt--precheck_delete--api"></a>
### Nested Schema for `precheck_delete.api`

Required:

- `status` (Attributes) The expected status sentinels for each polling state. (see [below for nested schema](#nestedatt--precheck_delete--api--status))
- `status_locator` (String) Specifies how to discover the status property. The format is either `code` or `scope.path`, where `scope` can be either `header` or `body`, and the `path` is using the [gjson syntax](https://github.com/tidwall/gjson/blob/master/SYNTAX.md). The `path` can contain `$(body.x.y.z)` parameter that reference property from the `state.output`.

Optional:

- `default_delay_sec` (Number) The interval between two pollings if there is no `Retry-After` in the response header, in second. Defaults to `10`.
- `header` (Map of String) The header parameters. This overrides the `header` set in the resource block.
- `path` (String) The path used to query readiness, relative to the `base_url` of the provider. By default, the `id` of this resource is used.
- `query` (Map of List of String) The query parameters. This overrides the `query` set in the resource block.

<a id="nestedatt--precheck_delete--api--status"></a>
### Nested Schema for `precheck_delete.api.status`

Required:

- `success` (String) The expected status sentinel for suceess status.

Optional:

- `pending` (List of String) The expected status sentinels for pending status.




<a id="nestedatt--precheck_update"></a>
### Nested Schema for `precheck_update`

Optional:

- `api` (Attributes) Keeps waiting until the specified API meets the success status (see [below for nested schema](#nestedatt--precheck_update--api))
- `mutex` (String) The name of the mutex, which implies the resource will keep waiting until this mutex is held

<a id="nestedatt--precheck_update--api"></a>
### Nested Schema for `precheck_update.api`

Required:

- `status` (Attributes) The expected status sentinels for each polling state. (see [below for nested schema](#nestedatt--precheck_update--api--status))
- `status_locator` (String) Specifies how to discover the status property. The format is either `code` or `scope.path`, where `scope` can be either `header` or `body`, and the `path` is using the [gjson syntax](https://github.com/tidwall/gjson/blob/master/SYNTAX.md). The `path` can contain `$(body.x.y.z)` parameter that reference property from the `state.output`.

Optional:

- `default_delay_sec` (Number) The interval between two pollings if there is no `Retry-After` in the response header, in second. Defaults to `10`.
- `header` (Map of String) The header parameters. This overrides the `header` set in the resource block.
- `path` (String) The path used to query readiness, relative to the `base_url` of the provider. By default, the `id` of this resource is used.
- `query` (Map of List of String) The query parameters. This overrides the `query` set in the resource block.

<a id="nestedatt--precheck_update--api--status"></a>
### Nested Schema for `precheck_update.api.status`

Required:

- `success` (String) The expected status sentinel for suceess status.

Optional:

- `pending` (List of String) The expected status sentinels for pending status.




<a id="nestedatt--update_body_patches"></a>
### Nested Schema for `update_body_patches`

Required:

- `path` (String) The path (in [gjson syntax](https://github.com/tidwall/gjson/blob/master/SYNTAX.md)) to the attribute to [patch](https://github.com/tidwall/sjson?tab=readme-ov-file#set-a-value).
- `raw_json` (String) The raw json used as the patch value. It can contain `$(body.x.y.z)` parameter that reference property from the `state.output`.

## Import

Import is supported using the following syntax:

```shell
# The import spec consists of following keys:
#
# - id (Required)                        : The resource id.
# - path (Required)                      : The path used to create the resource (as this is force new)
# - query (Optional)                     : The query parameters.
# - header (Optional)                    : The header.
# - body (Optional)                      : The interested properties in the response body that you want to manage via this resource.
#                                          If you omit this, then all the properties will be keeping track, which in most cases is 
#                                          not what you want (e.g. the read only attributes shouldn't be managed).
#                                          The value of each property is not important here, hence leave them as `null`.
# - read_selector (Optional)             : The read_selector used to specify the resource from a collection of resources.
# - read_response_template (Optional)    : The read_response_template used to transform the structure of the read response.
terraform import restful_resource.example '{
  "id": "/subscriptions/0-0-0-0/resourceGroups/example",
  "path": "/subscriptions/0-0-0-0/resourceGroups/example",
  "query": {"api-version": ["2020-06-01"]},
  "body": {
    "location": null,
    "tags": null
  }
}'
```
